## 1. 企画概要

### システム名称（仮）

投資対象銘柄選定・日次判定バッチシステム

### 目的

全銘柄の価格データおよび各種指標を基に、投資対象銘柄マスタを作成・更新し、
日次で対象銘柄の指標判定を行うことにより、適切な投資銘柄を特定すること。

### この業務が無いと困ること

適切な投資銘柄を特定できない。

### 成功している状態の定義

* 投資対象銘柄が見つかった場合に通知が送信されること
* 投資銘柄の有無に関わらず、判定結果のログが記録されていること

### 成功状態の測定方法

* 通知が送信されていること
* 判定結果のログが記録されていること

---

## 2. As-Is業務定義

### 開始トリガー

* 月1回のバッチ実行
* 毎日のバッチ実行

### 終了条件

* 月次：投資対象銘柄マスタ（M039）が更新された時点
* 日次：判定結果のログ記録および必要時の通知が完了した時点

### 業務外範囲

定義しない。

### 実行主体

システムバッチ処理。

### 判断方法

* 月次：各種指標結果に基づき、日々監視銘柄を判定する
* 日次：投資判断用指標の結果に基づき、投資対象銘柄の有無を判定する

### 属人判断

**未定義**

### 業務フロー

#### 月次処理（M010–M030）

1. 全銘柄マスタ（01_全銘柄マスタ）を参照する
2. 全銘柄価格取得メソッド（M010）を実行し、価格累積データを出力する
3. スタイル指標演算メソッド（M020）を実行し、投資スタイル判定用指標を出力する
4. 日々監視銘柄判定メソッド（M030）を実行し、各種指標合計データを出力する
5. 判定結果を基に投資対象銘柄マスタ（M039）を更新する
6. マスタ更新をもって終了する

#### 日次処理（M110–M130）

1. 投資対象銘柄マスタ（M039）を参照する
2. 対象銘柄価格取得メソッド（M110）を実行し、価格累積データを出力する
3. 投資指標作成メソッド（M120）を実行し、投資判断用指標データを出力する
4. 指標結果判定メソッド（M130）を実行する
5. 投資銘柄の有無を判定する
6. 判定結果のログを記録する
7. 投資対象銘柄が存在する場合のみ通知を行う
8. ログ記録および必要時の通知完了をもって終了する

### 判断・分岐

* 月次：日々監視銘柄かどうかを判定する
* 日次：投資対象銘柄が存在するかどうかを判定する

### 例外・戻り

定義しない。

### 振り返り

定義しない。

---

## 3. BPMN可視化

### BPMN表示用URL

[https://demo.bpmn.io/](https://demo.bpmn.io/)

### BPMN.io インポート用XML

※ユーザー指示時に表示します

---

## 4. UTF-8での保存手順（ユーザー向け）

1. BPMN XMLをテキストエディタに貼り付ける
2. 文字コードを UTF-8（BOMなし）で保存する
3. 拡張子を `.bpmn` または `.xml` とする
4. [https://demo.bpmn.io/](https://demo.bpmn.io/) を開く
5. Import diagram からファイルを読み込む

---

## 5. 本ドキュメントの位置づけ

### 位置づけ

* 本ドキュメントは As-Is業務定義を目的とした企画書である
* To-Be、改善案、設計書、実装仕様は含まない
* BPMN図は本文内容を忠実に可視化したものである

---

### 事実確認事項（確認のみ）

* ログは日次処理ごとに1回記録される認識で正しいか
* 通知は投資対象銘柄が1件以上存在する場合に実行される認識で正しいか
* 月次処理では通知およびログ記録は行わない認識で正しいか
